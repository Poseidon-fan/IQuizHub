import{d as T,o as d,i as F,e as t,_ as L,a as r,c as b,b as s,w as a,v as n,p as oe,f as le,r as f,q as ae,u as se,k as ne,j as B,x as re,F as I,h as q,C as ce,t as g,E as x,A as ue,y as ie}from"./index-dg0POEbG.js";import{a as S}from"./index-D4ibRccp.js";import{s as de}from"./Search-CwHlSzEf.js";var H=T({name:"ChatDotRound"});const _e={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},pe=t("path",{fill:"currentColor",d:"m174.72 855.68 135.296-45.12 23.68 11.84C388.096 849.536 448.576 864 512 864c211.84 0 384-166.784 384-352S723.84 160 512 160 128 326.784 128 512c0 69.12 24.96 139.264 70.848 199.232l22.08 28.8-46.272 115.584zm-45.248 82.56A32 32 0 0 1 89.6 896l58.368-145.92C94.72 680.32 64 596.864 64 512 64 299.904 256 96 512 96s448 203.904 448 416-192 416-448 416a461.056 461.056 0 0 1-206.912-48.384l-175.616 58.56z"},null,-1),me=t("path",{fill:"currentColor",d:"M512 563.2a51.2 51.2 0 1 1 0-102.4 51.2 51.2 0 0 1 0 102.4zm192 0a51.2 51.2 0 1 1 0-102.4 51.2 51.2 0 0 1 0 102.4zm-384 0a51.2 51.2 0 1 1 0-102.4 51.2 51.2 0 0 1 0 102.4z"},null,-1);function ve(_,y,c,$,p,k){return d(),F("svg",_e,[pe,me])}H.render=ve;H.__file="packages/components/ChatDotRound.vue";var j=T({name:"Menu"});const fe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},ge=t("path",{fill:"currentColor",d:"M160 448a32 32 0 0 1-32-32V160.064a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V416a32 32 0 0 1-32 32H160zm448 0a32 32 0 0 1-32-32V160.064a32 32 0 0 1 32-32h255.936a32 32 0 0 1 32 32V416a32 32 0 0 1-32 32H608zM160 896a32 32 0 0 1-32-32V608a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32v256a32 32 0 0 1-32 32H160zm448 0a32 32 0 0 1-32-32V608a32 32 0 0 1 32-32h255.936a32 32 0 0 1 32 32v256a32 32 0 0 1-32 32H608z"},null,-1);function he(_,y,c,$,p,k){return d(),F("svg",fe,[ge])}j.render=he;j.__file="packages/components/Menu.vue";const be={},N=_=>(oe("data-v-ddfb2a5c"),_=_(),le(),_),ye={class:"sheet-editor-header"},$e={class:"se-header-container"},Ce=N(()=>s("a",{href:"#"},"group-page",-1)),ke=N(()=>s("h1",null,"群组界面",-1));function we(_,y){const c=r("el-breadcrumb-item"),$=r("el-breadcrumb");return d(),b("div",ye,[s("div",$e,[t($,{separator:"/",class:"breadcrumb"},{default:a(()=>[t(c,{to:{path:"/staging"}},{default:a(()=>[n("staging")]),_:1}),t(c,null,{default:a(()=>[Ce]),_:1})]),_:1}),ke])])}const Ve=L(be,[["render",we],["__scopeId","data-v-ddfb2a5c"]]),xe={class:"GroupPage"},Se={class:"searchDiv"},ze={class:"search-icon-container"},De={class:"top"},Ge={class:"moduleSelect"},Me={class:"tagTitle"},Ee=["onClick"],Be={class:"groupSelect"},Ie=["onClick"],Te={class:"picture"},He={class:"side"},je={class:"side1"},Ae={class:"word"},Pe={class:"side2"},Ue={class:"word"},qe={class:"comment"},Fe={slot:"footer",class:"dialog-footer"},Le=T({__name:"GroupPage",setup(_){const y=f([{id:"1",name:"学术版",color:"#e84444"},{id:2,name:"科研版",color:"#d6b663"},{id:3,name:"生活版",color:"#352806"}]),c=f(0);function $(o){const e=y.value.find(v=>v.name===o);return e?e.color:"danger"}const p=f(""),k=async()=>{console.log("searchQuery:",p.value,c);try{const o=await S.searchGroupDetail({title:p.value,type:c.value.toString()});h.value=o.results,x.success(`搜索关键词: ${p.value}`),console.log("res:",o)}catch(o){console.error("Error fetching group detail:",o),x.error("搜索关键词不能为空")}};ae(()=>{z()});const h=f([]),z=async()=>{try{const o=await S.getAllGroups();for(let e=0;e<o.results.length;e++)o.results[e].create_time=A(o.results[e].create_time),o.results[e].update_time=A(o.results[e].update_time);h.value=o.results,console.log("res:",o)}catch(o){console.error("Error fetching groups:",o)}};function A(o){const e=new Date(o),v=e.getFullYear(),C=String(e.getMonth()+1).padStart(2,"0"),u=String(e.getDate()).padStart(2,"0"),V=String(e.getHours()).padStart(2,"0"),G=String(e.getMinutes()).padStart(2,"0");return`${v}-${C}-${u} ${V}:${G}`}const K=async o=>{try{await S.createGroup(o)&&await z()}catch(e){console.error("Error creating group:",e)}},w=f(!1),i=f({title:"",content:"",type:""}),Q=async()=>{await K(i.value),await z(),P();const o=ue.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});setTimeout(()=>{o.close()},500)},P=()=>{w.value=!1},m=f(0),D=se().username,R=ne(()=>(console.log("username:",D),console.log("lgq:",m.value),m.value===0?h.value:m.value===1?h.value.filter(o=>o.author.username==D):m.value===2?h.value.filter(o=>o.author.username!=D):h.value)),Y=o=>{ie.push(`/groupDetail/${o}`)},J=async o=>{try{await S.joinGroup({usergroup_id:o})&&x.success("加入成功")}catch(e){console.error("Error joining group:",e),x.error("加入失败")}};return(o,e)=>{const v=r("el-icon"),C=r("el-input"),u=r("el-button"),V=r("el-tag"),G=r("el-image"),O=r("el-aside"),W=r("el-main"),X=r("el-container"),M=r("el-form-item"),E=r("el-option"),Z=r("el-select"),ee=r("el-form"),te=r("el-dialog");return d(),b(I,null,[t(Ve),s("div",xe,[s("div",Se,[t(C,{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=l=>p.value=l),placeholder:"查找题单",onKeyup:re(k,["enter"])},{prepend:a(()=>[s("div",ze,[t(v,{size:"20px"},{default:a(()=>[t(B(de))]),_:1})])]),_:1},8,["modelValue"]),s("div",null,[t(u,{type:"primary",onClick:k},{default:a(()=>[n("搜索")]),_:1})])]),s("div",De,[s("div",Ge,[s("div",Me,[t(v,{size:"23"},{default:a(()=>[t(B(j))]),_:1}),s("h6",{onClick:e[1]||(e[1]=l=>c.value=0),style:{cursor:"pointer"}},"全部模块")]),(d(!0),b(I,null,q(y.value,l=>(d(),b("div",{class:ce(["tagAll",{selected:l.id===c.value}]),key:l.id,onClick:U=>c.value=l.id},[t(V,{effect:"light",round:"round",color:l.color},{default:a(()=>[n(" ")]),_:2},1032,["color"]),n(" "+g(l.name),1)],10,Ee))),128))]),s("div",Be,[t(u,{type:"success",style:{"margin-top":"20px"},class:"elb",onClick:e[2]||(e[2]=l=>m.value=0)},{default:a(()=>[n("全部群组")]),_:1}),t(u,{type:"info",style:{"margin-top":"20px"},class:"elb",onClick:e[3]||(e[3]=l=>m.value=1)},{default:a(()=>[n("我创建的群组")]),_:1}),t(u,{type:"primary",style:{"margin-top":"20px"},class:"elb",onClick:e[4]||(e[4]=l=>m.value=2)},{default:a(()=>[n("我加入的群组")]),_:1}),t(u,{color:"#666",style:{"margin-top":"20px"},class:"elb",onClick:e[5]||(e[5]=l=>w.value=!0)},{default:a(()=>[n(" 创建属于我的群组 ")]),_:1})])]),(d(!0),b(I,null,q(R.value,l=>(d(),b("div",{class:"allBlock",key:l.id},[s("div",{class:"block",onClick:U=>Y(l.id)},[t(X,null,{default:a(()=>[t(O,{width:"100px"},{default:a(()=>[s("div",Te,[t(G,{src:"https://pic2.zhimg.com/v2-0dda71bc9ced142bf7bb2d6adbebe4f0_r.jpg?source=1940ef5c"})])]),_:1}),t(W,null,{default:a(()=>[s("div",He,[s("div",je,[s("h2",null,g(l.title),1),s("div",Ae,[s("p",null,g(l.author.username),1),n("创建于"+g(l.create_time),1)])]),s("div",Pe,[t(V,{effect:"light",round:"round",color:$(l.type)},{default:a(()=>[n(" ")]),_:2},1032,["color"]),n(" "+g(l.type)+" ",1),t(u,{type:"primary",style:{"margin-left":"160px"},onClick:U=>J(l.id),disabled:"item.is_in"},{default:a(()=>[n("加入 ")]),_:2},1032,["onClick"]),s("div",Ue,[s("div",qe,[t(v,{size:"13px"},{default:a(()=>[t(B(H))]),_:1}),n(" "+g(l.cnt),1)]),n(" 最后回复于"+g(l.update_time),1)])])])]),_:2},1024)]),_:2},1024)],8,Ie)]))),128)),t(te,{modelValue:w.value,"onUpdate:modelValue":e[9]||(e[9]=l=>w.value=l),width:"500",title:"创建我的群组",class:"custom-dialog"},{default:a(()=>[t(ee,{model:i.value},{default:a(()=>[t(M,{label:"群组名称"},{default:a(()=>[t(C,{modelValue:i.value.title,"onUpdate:modelValue":e[6]||(e[6]=l=>i.value.title=l)},null,8,["modelValue"])]),_:1}),t(M,{label:"群组简介"},{default:a(()=>[t(C,{modelValue:i.value.content,"onUpdate:modelValue":e[7]||(e[7]=l=>i.value.content=l)},null,8,["modelValue"])]),_:1}),t(M,{label:"群组类型"},{default:a(()=>[t(Z,{modelValue:i.value.type,"onUpdate:modelValue":e[8]||(e[8]=l=>i.value.type=l),placeholder:"请选择"},{default:a(()=>[t(E,{label:"学术版",value:"学术版"}),t(E,{label:"科研版",value:"科研版"}),t(E,{label:"生活版",value:"生活版"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),s("span",Fe,[t(u,{onClick:P},{default:a(()=>[n("取消")]),_:1}),t(u,{type:"primary",onClick:Q},{default:a(()=>[n("提交")]),_:1})])]),_:1},8,["modelValue"])])],64)}}}),Ye=L(Le,[["__scopeId","data-v-5cd1b86a"]]);export{Ye as default};
