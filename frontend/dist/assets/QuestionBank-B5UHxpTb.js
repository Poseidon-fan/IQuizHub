import{_ as N,a as c,o as p,c as q,b as S,e as t,w as a,v as h,p as H,f as P,r as o,i as b,F as A,h as F,j as M,I as K,x as L,t as E,E as U,J as W,d as j,z as X,n as Z,y as ee,q as ae}from"./index-dg0POEbG.js";import{s as te}from"./Search-CwHlSzEf.js";import{a as R}from"./index-D4ibRccp.js";const le={},J=d=>(H("data-v-577f69f3"),d=d(),P(),d),ne={class:"sheet-editor-header"},oe={class:"se-header-container"},se=J(()=>S("a",{href:"#"},"question-bank",-1)),ue=J(()=>S("h1",null,"题库",-1));function ce(d,m){const s=c("el-breadcrumb-item"),f=c("el-breadcrumb");return p(),q("div",ne,[S("div",oe,[t(f,{separator:"/",class:"breadcrumb"},{default:a(()=>[t(s,{to:{path:"/staging"}},{default:a(()=>[h("staging")]),_:1}),t(s,null,{default:a(()=>[se]),_:1})]),_:1}),ue])])}const re=N(le,[["render",ce],["__scopeId","data-v-577f69f3"]]),ie=d=>(H("data-v-5b2b9ac2"),d=d(),P(),d),de={class:"search-icon-container"},_e=ie(()=>S("span",{style:{"font-size":"19px"}},"标签",-1)),pe={class:"flex gap-2"},ve={__name:"QBNav",props:{total:Number},emits:["updateSearchStatus","updateSearchQuery","updateSearchTags","updateSearchType"],setup(d,{emit:m}){const s=o(""),f=o(!1),i=m,V=async()=>{if(s.value===""){U.error("搜索关键词不能为空");return}U.success(`搜索关键词: ${s.value}`),f.value=!0,i("updateSearchQuery",s),i("updateSearchTags",l),i("updateSearchType",r),i("updateSearchStatus",f)};o([{value:"easy",label:"简单"},{value:"medium",label:"中等"},{value:"hard",label:"困难"},{value:"all",label:"全部"}]);const w=o([{value:"single_choice",label:"单选题"},{value:"multiple_choice",label:"多选题"},{value:"fill_in_the_blank",label:"填空题"},{value:"true_false",label:"判断题"},{value:"all",label:"全部"}]),B=o(""),r=o(""),g=o(""),l=o([]),y=o(!1),k=o(["success","info","warning","danger",""]),D=()=>{y.value=!0,W(()=>{})},z=C=>{l.value.splice(l.value.indexOf(C),1)},Q=()=>{if(g.value){const C=Math.floor(Math.random()*5),e=k.value[C];l.value.push({name:g.value,type:e})}y.value=!1,g.value=""};function u(){B.value="",r.value="",s.value="",l.value=[],f.value=!1,U.success("清除关键词和Tag"),i("updateSearchStatus",f),i("updateSearchQuery",s),i("updateSearchTags",l),i("updateSearchType",r)}return(C,e)=>{const n=c("el-option"),x=c("el-select"),v=c("el-col"),$=c("el-icon"),T=c("el-button"),I=c("el-row"),O=c("el-tag"),Y=c("el-header"),G=c("el-container");return p(),b(G,{class:"qs-nav-container"},{default:a(()=>[t(Y,{class:"header"},{default:a(()=>[t(I,{gutter:20},{default:a(()=>[t(v,{span:5},{default:a(()=>[t(x,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=_=>r.value=_),placeholder:"题目类型",size:"default",style:{width:"200px"}},{default:a(()=>[(p(!0),q(A,null,F(w.value,_=>(p(),b(n,{key:_.value,label:_.label,value:_.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(v,{span:8},{default:a(()=>[t(M(K),{modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=_=>s.value=_),placeholder:"请输入您想查找的内容或关键词",onKeyup:L(V,["enter"])},{prepend:a(()=>[S("div",de,[t($,{size:"20px"},{default:a(()=>[t(M(te))]),_:1})])]),_:1},8,["modelValue"])]),_:1}),t(v,{span:4},{default:a(()=>[t(T,{type:"primary",onClick:V},{default:a(()=>[h("搜索")]),_:1})]),_:1})]),_:1}),t(I,{gutter:20,style:{"margin-top":"20px"}},{default:a(()=>[t(v,{span:1.5,style:{"margin-top":"1px"}},{default:a(()=>[_e]),_:1}),t(v,{span:12},{default:a(()=>[S("div",pe,[(p(!0),q(A,null,F(l.value,_=>(p(),b(O,{key:_.name,closable:"","disable-transitions":!1,onClose:Se=>z(_),type:_.type},{default:a(()=>[h(E(_.name),1)]),_:2},1032,["onClose","type"]))),128)),y.value?(p(),b(M(K),{key:0,ref:"InputRef",modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=_=>g.value=_),class:"w-20",size:"default",onKeyup:L(Q,["enter"]),onBlur:Q,style:{"margin-top":"4px"}},null,8,["modelValue"])):(p(),b(T,{key:1,class:"button-new-tag",size:"small",onClick:D},{default:a(()=>[h(" + New Tag ")]),_:1}))])]),_:1})]),_:1}),t(I,{gutter:20,style:{"margin-top":"20px"}},{default:a(()=>[t(v,{span:24},{default:a(()=>[S("span",null,"共计 "+E(d.total)+" 条结果",1)]),_:1})]),_:1}),t(I,{gutter:20,style:{"margin-top":"20px"}},{default:a(()=>[t(v,{span:24},{default:a(()=>[S("p",{onClick:u,class:"cleanAll"},"清除所有筛选条件")]),_:1})]),_:1})]),_:1})]),_:1})}}},me=N(ve,[["__scopeId","data-v-5b2b9ac2"]]),fe={class:"table-container"},he=j({__name:"QBList",props:{tableData:Array,total:Number},emits:["pageChange","deleteRow"],setup(d,{emit:m}){const s=m,f=o(1),i=o(20),V=r=>{s("pageChange",r),f.value=r},w=r=>{ee.push(`/question-detail/${r}`)},B=r=>{s("deleteRow",r)};return(r,g)=>{const l=c("el-table-column"),y=c("el-link"),k=c("el-tag"),D=c("el-button"),z=c("el-table"),Q=c("el-pagination");return p(),q("div",fe,[t(z,{data:d.tableData,style:{width:"100%"}},{default:a(()=>[t(l,{prop:"id",label:"编号"}),t(l,{prop:"create_time",label:"创建时间"}),t(l,{label:"题目名称"},{default:a(u=>[t(y,{onClick:X(C=>w(u.row.id),["prevent"]),type:"primary",underline:""},{default:a(()=>[h(E(u.row.title),1)]),_:2},1032,["onClick"])]),_:1}),t(l,{label:"题目作者"},{default:a(u=>[t(y,{href:u.row.url,type:"info",underline:""},{default:a(()=>[h(E(u.row.author),1)]),_:2},1032,["href"])]),_:1}),t(l,{label:"题目类型"},{default:a(u=>[u.row.type=="True/False"?(p(),b(k,{key:0},{default:a(()=>[h("判断题")]),_:1})):u.row.type=="single_choice"?(p(),b(k,{key:1},{default:a(()=>[h("单选题")]),_:1})):u.row.type=="multiple_choice"?(p(),b(k,{key:2},{default:a(()=>[h("多选题")]),_:1})):u.row.type=="fill_blanks"?(p(),b(k,{key:3},{default:a(()=>[h("填空题")]),_:1})):Z("",!0)]),_:1}),t(l,{label:"操作"},{default:a(u=>[t(D,{type:"danger",onClick:C=>B(u.row.id),size:"small"},{default:a(()=>[h("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(Q,{onCurrentChange:V,"current-page":f.value,"page-size":i.value,total:d.total,layout:"prev, pager, next"},null,8,["current-page","page-size","total"])])}}}),ge=N(he,[["__scopeId","data-v-16ebcec5"]]),ye={class:"question-bank-container"},be=j({__name:"QuestionBank",setup(d){const m=o([]),s=o(0),f=async e=>{try{const n=await R.getAllQuestions({pageNumber:e});m.value=n.results,s.value=n.count,m.value.forEach(x=>{x.create_time=u(x.create_time)})}catch(n){console.error("Error fetching questions:",n)}},i=o(1),V=e=>{w(e),i.value=e},w=e=>{console.log("----->isSearching:",l.value,e),l.value.value==!0?B(e,g.value,r.value,y.value):f(e)};ae(()=>{w(1)});const B=async(e,n,x,v)=>{try{console.log("searching:-----------",v);const $=await R.search({pageNumber:e,Tags:n,keyword:x,type:v});m.value=$.results,s.value=$.count,console.log("search result:",m.value),m.value.forEach(T=>{T.create_time=u(T.create_time)})}catch($){console.error("Error searching questions:",$)}},r=o(""),g=o([]),l=o(!1),y=o(""),k=e=>{l.value=e,console.log("isSearching:",l.value,i.value),w(i.value)},D=e=>{r.value=e.value},z=e=>{if(console.log("typeValue:",e.value),e.value==="all"){y.value="";return}y.value=e.value},Q=e=>{g.value=e.value.map(n=>n.name),console.log("dynamicTags:",e.value),console.log("tags:",g.value)};function u(e){const n=new Date(e),x=n.getFullYear(),v=String(n.getMonth()+1).padStart(2,"0"),$=String(n.getDate()).padStart(2,"0"),T=String(n.getHours()).padStart(2,"0"),I=String(n.getMinutes()).padStart(2,"0");return`${x}-${v}-${$} ${T}:${I}`}const C=async e=>{try{await R.deleteQuestion({id:e}),w(i.value)}catch(n){console.error("Error deleting question sheet:",n)}};return(e,n)=>(p(),q(A,null,[t(re),S("div",ye,[t(me,{onUpdateSearchStatus:k,onUpdateSearchQuery:D,onUpdateSearchTags:Q,onUpdateSearchType:z,total:s.value},null,8,["total"]),t(ge,{tableData:m.value,onPageChange:V,onDeleteRow:C,total:s.value},null,8,["tableData","total"])])],64))}}),xe=N(be,[["__scopeId","data-v-8d2ded0d"]]);export{xe as default};
