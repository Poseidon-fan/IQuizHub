import{a as S}from"./index-D4ibRccp.js";import{_ as E,r as i,a as d,o as h,c as V,e,w as l,v as m,i as Q,n as A,b as o,F as L,h as O,t as B,E as y,p as N,f as z,d as D,L as M,T as j,P as q,M as W,U as X,N as G,S as H,O as J,Q as K,R as Y,V as Z,W as ee,X as te,q as oe,k as le}from"./index-dg0POEbG.js";const ae=u=>(N("data-v-d0b81f9b"),u=u(),z(),u),se={class:"container"},ne=ae(()=>o("p",{style:{"font-weight":"bold","font-size":"20px","margin-bottom":"20px"}},"OCR识别",-1)),ie={class:"dialog-footer"},re={__name:"EditorOCR",setup(u){const x=i(!1),v=i(""),_=i([]),b=i(!1),r=i([]),U=g=>{const s=new FileReader;s.onload=async()=>{b.value=!0;try{const c=s.result.split(",")[1],a=await S.ocr({base64_img:c}),w=a.data.image_url,p=a.data.texts;v.value=w,_.value.push(w),r.value=p,x.value=!0,y.success("ocr识别成功")}catch{y.error("ocr识别失败，是不是没有文字内容呢？")}b.value=!1},g.raw&&s.readAsDataURL(g.raw)};function T(){const g=r.value.join(`
`);navigator.clipboard?navigator.clipboard.writeText(g).then(()=>{y.success("复制成功")}).catch(()=>{y.error("复制失败")}):y.warning("复制失败")}return(g,s)=>{const c=d("el-button"),a=d("el-upload"),w=d("el-image"),p=d("el-skeleton"),t=d("el-dialog");return h(),V("div",se,[ne,e(a,{class:"upload-demo",action:"#","on-change":U,"show-file-list":!1,accept:"image/*"},{default:l(()=>[e(c,{size:"small",type:"primary"},{default:l(()=>[m("点击上传图片")]),_:1})]),_:1}),e(p,{loading:b.value,animated:"",style:{"margin-top":"20px"}},{default:l(()=>[v.value?(h(),Q(w,{key:0,style:{width:"100%","margin-top":"20px"},src:v.value,"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":_.value,"initial-index":4,fit:"cover"},null,8,["src","preview-src-list"])):A("",!0)]),_:1},8,["loading"]),e(t,{modelValue:x.value,"onUpdate:modelValue":s[1]||(s[1]=f=>x.value=f),title:"识别结果",width:"500",draggable:""},{footer:l(()=>[o("div",ie,[e(c,{onClick:T},{default:l(()=>[m("复制所有")]),_:1}),e(c,{onClick:s[0]||(s[0]=f=>x.value=!1)},{default:l(()=>[m("关闭")]),_:1})])]),default:l(()=>[(h(!0),V(L,null,O(r.value,f=>(h(),V("p",{key:f,style:{margin:"10px 0"}},B(f),1))),128))]),_:1},8,["modelValue"])])}}},ce=E(re,[["__scopeId","data-v-d0b81f9b"]]),C=u=>(N("data-v-f68ede6a"),u=u(),z(),u),de={class:"editor-container"},ue={class:"editor-left"},pe={class:"editor-right"},_e=C(()=>o("div",{class:"type"},null,-1)),me={class:"option-input"},ve={class:"option-list"},ge={style:{"margin-right":"10px !important"}},fe={class:"type"},ye=C(()=>o("strong",{style:{"margin-top":"15px","align-items":"center"}},"type",-1)),he={class:"title",style:{display:"flex"}},xe=C(()=>o("strong",{style:{"margin-top":"10px","align-items":"center"}},"title",-1)),be={class:"answer",style:{display:"flex"}},we=C(()=>o("strong",{style:{"margin-top":"15px","align-items":"center"}},"answer",-1)),Ve={class:"ocr"},ke=D({__name:"QuestionEditor",props:{type:{}},setup(u){const x=[M,j,q,W.configure({bubble:!0}),X.configure({bubble:!0,menubar:!1}),G,H,J,K,Y,Z,ee.configure({bubble:!0}),te.configure({bubble:!0})],v=i(""),_=i(null);oe(()=>{_.value&&_.value.editor});const b=p=>{_.value&&_.value.editor.chain().focus().insertContent(p).run()},r=i([]),U=le(()=>r.value.length),T=p=>{r.value.splice(p,1)},g=()=>{r.value.push({text:""})},s=i(""),c=i(""),a=i(""),w=async()=>{console.log(r.value[0].text),await S.uploadQuestion({type:a.value,content:v.value,answer:s.value,title:c.value,choices:r.value.map(t=>t.text)})?y({message:"上传成功",type:"success",duration:3e3}):y({message:"上传失败",type:"error",duration:3e3})};return(p,t)=>{const f=d("el-tiptap"),k=d("el-button"),$=d("el-input"),I=d("el-option"),P=d("el-select");return h(),V("div",de,[o("div",ue,[e(f,{content:v.value,"onUpdate:content":t[0]||(t[0]=n=>v.value=n),extensions:x,ref_key:"editorRef",ref:_},null,8,["content"])]),o("div",pe,[_e,e(k,{type:"primary",onClick:t[1]||(t[1]=n=>b(" (  ) ")),disabled:a.value!=="single_choice"&&a.value!=="multiple_choice"},{default:l(()=>[m(" 插入选择框 ")]),_:1},8,["disabled"]),e(k,{type:"primary",onClick:t[2]||(t[2]=n=>b(" ____ ")),disabled:a.value!=="short_answer"},{default:l(()=>[m(" 插入填空线 ")]),_:1},8,["disabled"]),e(k,{type:"primary",onClick:g,disabled:U.value>=4||a.value!=="multiple_choice"&&a.value!=="single_choice"},{default:l(()=>[m(" 添加选项 ")]),_:1},8,["disabled"]),o("div",me,[o("div",ve,[(h(!0),V(L,null,O(r.value,(n,F)=>(h(),V("div",{class:"options",key:F,style:{display:"flex","align-items":"center"}},[o("p",ge,B(String.fromCharCode(65+F)),1),e($,{modelValue:n.text,"onUpdate:modelValue":R=>n.text=R,placeholder:"请输入选项内容",class:"option-item"},{append:l(()=>[e(k,{type:"danger",onClick:R=>T(F)},{default:l(()=>[m("删除")]),_:2},1032,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]))),128))])]),o("div",fe,[ye,e(P,{modelValue:a.value,"onUpdate:modelValue":t[3]||(t[3]=n=>a.value=n),placeholder:"请选择题目类型",style:{"margin-top":"10px","margin-left":"20px"}},{default:l(()=>[e(I,{label:"single_choice",value:"single_choice"}),e(I,{label:"True/False",value:"True/False"})]),_:1},8,["modelValue"])]),o("div",he,[xe,e($,{modelValue:c.value,"onUpdate:modelValue":t[4]||(t[4]=n=>c.value=n),style:{width:"240px","margin-left":"35px"},placeholder:"Please input title"},null,8,["modelValue"])]),o("div",be,[we,e($,{modelValue:s.value,"onUpdate:modelValue":t[5]||(t[5]=n=>s.value=n),style:{width:"240px","margin-top":"10px","margin-left":"10px"},placeholder:"Please input answer"},null,8,["modelValue"])]),e(k,{type:"primary",style:{"margin-top":"10px"},onClick:w},{default:l(()=>[m("上传")]),_:1}),o("div",Ve,[e(ce)])])])}}}),Te=E(ke,[["__scopeId","data-v-f68ede6a"]]);export{Te as default};
